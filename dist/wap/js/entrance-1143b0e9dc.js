!function e(t,s,n){function a(i,r){if(!s[i]){if(!t[i]){var c="function"==typeof require&&require;if(!r&&c)return c(i,!0);if(o)return o(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=s[i]={exports:{}};t[i][0].call(u.exports,function(e){var s=t[i][1][e];return a(s?s:e)},u,u.exports,e,t,s,n)}return s[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,s){var n={preURLLink:document.referrer,getQueryParam:function(){var e=location.href,t=e.substring(e.lastIndexOf("?")+1);t.lastIndexOf("#")>=0&&(t=t.substring(0,t.lastIndexOf("#")));for(var s=t.split("&"),n={},a=0;a<s.length;a++){var o=s[a],i=o.substring(0,o.indexOf("=")),r=o.substring(o.indexOf("=")+1);/^-?(\d+)(\.\d+)?$/.test(r)?n[i]=Number(r):"true"===r?n[i]=!0:"false"===r?n[i]=!1:n[i]=r}return n},getUrlRegex:function(e){e=e.replace(/&amp;/g,"&"),e=e.replace(/&amp/g,"&");for(var t="",s=e.split(/\s+/),n=0;n<s.length;n++){var a=function(e){var t=/((https?|ftp|news):\/\/)?([a-zA-Z]([a-z0-9A-Z\-]*[\.])+([a-zA-Z]{2}|(aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)(:[0-9]{1,4})?)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(:[0-9]{1,4})?)(\/[a-zA-Z0-9_%=#\-\.~]+)*(\/([a-zA-Z0-9%=#_\-\.]*)(\?[a-zA-Z0-9+_\/\-\.#%=&]*)?)?(#[a-zA-Z][a-zA-Z0-9_]*)?$/;if(e.match(t)){var s=/(https?):\/\/([a-zA-Z]([a-z0-9A-Z\-]*[\.])+([a-zA-Z]{2}|(aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)(:[0-9]{1,4})?)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(:[0-9]{1,4})?)(\/[a-zA-Z0-9_%=#\-\.~]+)*(\/([a-zA-Z0-9%=#_\-\.]*)(\?[a-zA-Z0-9+_\/\-\.#%=&]*)?)?(#[a-zA-Z][a-zA-Z0-9_]*)?$/;e=e.match(s)?'<a href="'+e+'" target="_blank">'+e+"</a>":'<a href="http://'+e+'" target="_blank">'+e+"</a>"}return e+" "}(s[n]);t+=a}return t},getNewUrlRegex:function(e){e=e.replace(/&amp;/g,"&"),e=e.replace(/&amp/g,"&");for(var t="",s=e.split(/\s+/),n=0;n<s.length;n++){var a=function(e){var t=/^(((https?):\/\/)|(www))[a-zA-Z0-9]+((\.(com|cn|org))|(:[0-9]{2,4}))?(:[0-9]{2,4})?([\/\?\.&\-=a-zA-Z0-9]+)?$/g;if(e.match(t))e=e.match(t)?'<a href="'+e+'" target="_blank">'+e+"</a>":'<a href="http://'+e+'" target="_blank">'+e+"</a>";else{var s=/((www.)|((https?):\/\/))[a-zA-Z0-9]+((\.(com|cn|org))|(:[0-9]{2,4}))?(:[0-9]{2,4})?([:\/\?\.&\-=a-zA-Z0-9]+)?/g,n=e.match(s);if(n&&n.length>0){var a=e.indexOf(n[0]),o=n[0].indexOf("http");o>=1?n[0]='<a href="'+n[0]+'" target="_blank">'+n[0]+"</a>":n[0]='<a href="http://'+n[0]+'" target="_blank">'+n[0]+"</a>",e=e.substring(0,a)+n[0]}}return e+" "}(s[n]);t+=a}return t},format:function(e,t,s){if(s){var n;if("object"==typeof t)for(var a in t){var o="{"+a+"}";n=e.replace(o,t[a])}else for(var i=0;i<t.length;i++){if(void 0==t[i])return"";var o="{"+i+"}";n=e.replace(o,t[i])}return n}return e}};t.exports=n},{}],2:[function(e,t,s){var n=function(){var t=e("./comm.js"),s=e("./util/promise.js"),n=new s,a={config_url:"/chat/user/config.action",init_url:"/chat/user/init.action"},o={};o.cacheInfo={},o.cacheInfo.flags={status:"enabled",isLoaded:!1,pageNow:1,pageSize:20,moreHistroy:!1,isConnected:!1,isEnableManual:!1,isEnableOnInput:!0,isGetCustomConfig:!1,isEnableBigImg:!0,isPeopleModel:!1,isWaitModel:!1,isTimeLine:!1,isUserTalked:!1,isSurveyed:!1,isKeepSessions:!1,isOutOneMinute:!1};var i=!0,r="CN",c=function(e){switch(e){case"CN":return{L10001:"暂时无法转接人工客服",L10002:"您好,{0}接受了您的请求",L10003:"您已经与服务器断开连接,{0}",L10004:"排队中，您在队伍中的第{0}个",L10005:"您在思考人生？有问题请随时提问哦",L10006:'<a href="javascript: window.location.reload();">重新接入</a>',L10007:"{0}有事离开了{1}",L10008:"您与{0}的会话已结束{1}",L10009:"{0}结束了本次会话",L10010:"您长时间没有说话，本次会话已结束。{0}",L10011:"{0}您已打开新聊天窗口{1}",L10012:"没有更多记录",L10013:"抱歉，您无法接入在线客服",L10014:"图片过大",L10015:"格式不支持",L10016:"正在加载...",L10017:"正在加载...",L10018:"下拉显示更多",L10019:"客服{0}发起了会话",L10020:"{0}正在输入",L10021:"本次会话结束{0}",L10022:'{0} 您可以<a href="javascript: void(0);" id="systemMsgLeaveMessage">留言</a>',L10023:'{0} <span  id="systemMsgLeaveMsg">请等待</span>'};case"EN":return{L10001:"Sorry!",L10002:"Hello,{0}Plase holdon"};case"JP":}},u={initParams:function(){var e=o.cacheInfo.urlParams={},s=t.getQueryParam();if(s)for(var n in s)e[n]=s[n]},initUA:function(){var e=o.cacheInfo.UAInfo={};uaList=["mz","xiaomi","android","ipad","iphone"],pcUaList=["windows","linux","mac"],uaListLen=uaList.length,pcUaListLen=pcUaList.length,userAgent=navigator.userAgent.toLowerCase(),uaWidth=$(window).width(),uaHeight=$(window).height(),uaIndex=0,iphoneVersion="iphone-5",returnUA="",e.uaHeight=uaHeight;for(var t=0,s="";t<uaListLen&&!returnUA.length;t++){if(s=uaList[t],uaIndex=userAgent.indexOf(s),"iphone"===s&&uaIndex>0){switch(uaWidth){case 320:iphoneVersion="iphone-5";break;case 375:iphoneVersion="iphone-6";break;case 414:iphoneVersion="iphone-6+"}e.iphoneVersion=iphoneVersion,e.UA=s;break}if(uaIndex>0){e.UA=s;break}}if(uaIndex<=0)for(var t=0,s="";t<pcUaListLen;t++)if(s=pcUaList[t],uaIndex=userAgent.indexOf(s),uaIndex>0){e.UA="pc";break}},initBrowser:function(){for(var e=o.cacheInfo.browser={},t=["mqqbrowser","qq","micromessenger","ucbrowser","miuibrowser","safari","opera mobi","opera mini","firefox"],s=t.length,n=navigator.userAgent.toLowerCase(),a=0,i=0,r="";s>i;i++)if(r=t[i],a=n.indexOf(r),a>0)return void(e.browser=r)},initLanguage:function(){var e=o.cacheInfo.language={};i?(e.open=!0,e.lan=c(r)):e.open=!1},initEventType:function(){var e=o.cacheInfo.eventType={};if("xiaomi"==o.cacheInfo.UAInfo.UA)e.type="mousedown";else if("pc"!=o.cacheInfo.UAInfo.UA){var t=/hp-tablet/gi.test(navigator.appVersion),s="ontouchstart"in window&&!t;e.type=s?"touchstart":"mousedown"}else e.type="click"},initUserInfo:function(){var e=4,s=t.getQueryParam(),n=s.source;o.cacheInfo.userInfo={source:n>=0?n:e,tel:s.tel?s.tel:"",uname:s.uname?s.uname:"",partnerId:s.partnerId?s.partnerId:"",email:s.email?s.email:"",visitUrl:s.visitUrl?s.visitUrl:t.preURLLink,visitTitle:s.visitTitle?s.visitTitle:"",face:s.face?s.face:"http://img.sobot.com/console/common/face/user.png",back:s.back?s.back:"",realname:s.realname?s.realname:"",weibo:s.weibo?s.weibo:"",weixin:s.weixin?s.weixin:"",qq:s.qq?s.qq:"",sex:s.sex?s.sex:"",birthday:s.birthday?s.birthday:"",remark:s.remark?s.remark:""}},initSysNum:function(){o.cacheInfo.sysNum=t.getQueryParam().sysNum}},l=function(){var e=new s;return $.ajax({url:"/wap/admins_new/getEnvironment",dataType:"json",data:{},success:function(t){e.resolve("success")},error:function(t){e.resolve("fail")}}),e},d=function(e){var t=["leaveMessage.html"],s=0;for(var n in e){var a=encodeURIComponent(e[n]);0==s?t.push("?"):t.push("&"),t.push(n+"="+a),s++}var o='您可以<a class="leave-msg-btn" href="'+t.join("")+'" >留言</a>';return o},f=function(){l().then(function(e,t){var t=t||new s;return u.initUA(),u.initParams(),u.initLanguage(),u.initSysNum(),u.initBrowser(),u.initUserInfo(),u.initEventType(),$.ajax({type:"post",url:a.config_url,dataType:"json",data:{sysNum:o.cacheInfo.sysNum,source:o.cacheInfo.userInfo.source},success:function(s){o.cacheInfo.apiConfig=s,"success"===e?s.websocketUrl="":s.websocketUrl="ws://139.129.95.94:9000/ws",t.resolve()}}),t}).then(function(){$.ajax({type:"post",url:a.init_url,dataType:"json",data:{sysNum:o.cacheInfo.sysNum,source:o.cacheInfo.userInfo.source,partnerId:o.cacheInfo.userInfo.partnerId,tel:o.cacheInfo.userInfo.tel,email:o.cacheInfo.userInfo.email,uname:o.cacheInfo.userInfo.uname,visitTitle:o.cacheInfo.userInfo.visitTitle,visitUsrl:o.cacheInfo.userInfo.visitUrl,face:o.cacheInfo.userInfo.face,realname:o.cacheInfo.userInfo.realname,weibo:o.cacheInfo.userInfo.weibo,weixin:o.cacheInfo.userInfo.weixin,qq:o.cacheInfo.userInfo.qq,sex:o.cacheInfo.userInfo.sex,birthday:o.cacheInfo.userInfo.birthday,remakr:o.cacheInfo.userInfo.remark},success:function(e){var t=e.data?e.data:e;o.cacheInfo.apiInit=t,o.cacheInfo.apiConfig.leaveMsg=0==o.cacheInfo.apiConfig.msgflag?d(o.cacheInfo.urlParams):"",n.resolve(o.cacheInfo)}})})},g=function(){f()};return g(),n};t.exports=n},{"./comm.js":1,"./util/promise.js":18}],3:[function(e,t,s){var n,a={},o=e("../util/listener.js");a.setCurrentState=function(e){n=e,o.trigger("core.statechange",n)},a.getCurrentState=function(){return n},t.exports=a},{"../util/listener.js":17}],4:[function(e,t,s){var n=function(t){var s,n,a=e("../util/listener.js"),o=e("../util/promise.js"),i=e("../util/date.js"),r=e("../socket/robot.js"),c=e("./currentState.js"),u=(e("../socket/websocket.js"),e("../socket/rolling.js")),l=e("./transfer.js"),d=e("./initsession.js"),f=e("../socket/socketfactory.js"),g=t.apiConfig.leaveMsg,p=function(e,s,n){var o=n?s.aface:t.apiConfig.robotLogo,r=n?s.aname:t.apiConfig.robotName,n=n||t.apiConfig.robotHelloWord;e||(e=[]);var u=new Date,l={date:i.formatDate(u),content:[{senderType:n?2:1,t:+u,msg:n,ts:i.formatDate(u,!0),senderFace:o,senderName:r}]};c.setCurrentState("human"),e.push(l),setTimeout(function(){a.trigger("core.initsession",e)},0)},m=function(e,n){e||(e=[]);var o=new Date,u={date:i.formatDate(o),content:[{senderType:1,t:+o,msg:t.apiConfig.robotHelloWord,ts:i.formatDate(o,!0),senderFace:t.apiConfig.robotLogo,senderName:t.apiConfig.robotName}]};e.push(u),s&&s.destroy(),s=new r(t),c.setCurrentState("robot"),setTimeout(function(){a.trigger("core.initsession",e)},0)},h=function(){var e=[],n=new Date,o={date:i.formatDate(n),content:[{senderType:1,t:+n,msg:t.apiConfig.robotHelloWord,ts:i.formatDate(n,!0),senderFace:t.apiConfig.robotLogo,senderName:t.apiConfig.robotName}]};e.push(o),s=new r(t),setTimeout(function(){a.trigger("core.initsession",e)},0)},v=function(e,o,i){var u="排队中，您在队伍中的第"+e.count+"个，请等待。";o?(p(i,e,null),setTimeout(function(){e.content=u+" "+g,a.trigger("core.system",{type:"system",status:"queue",data:e})},1)):(e.content=u+" "+g,a.trigger("core.system",{type:"system",status:"queue",data:e})),s&&s.destroy(),n=f(e,t),n.start(),s=new r(t),c.setCurrentState("robot")},y=function(e){for(var t=e.list||[],o=0,i=t.length;i>o;o++){var r=t[o],c=r;if(200===r.type){s&&s.destroy(),s=n,n=null,setCurrentState.setCurrentState("human"),a.trigger("core.system",{type:"system",status:"transfer",data:{content:"您好，客服"+c.aname+"接受了您的请求"}}),a.trigger("core.buttonchange",{type:"transfer",action:"hide"});break}}},j=function(e,n,o){s&&s.destroy(),s=new r(t),c.setCurrentState("robot"),a.trigger("core.buttonchange",{type:"transfer",action:"show"}),n?(p(o,e,null),setTimeout(function(){e.content=t.apiConfig.adminNonelineTitle+g,a.trigger("core.system",{type:"system",status:"offline",data:e})},1)):(e.content=t.apiConfig.adminNonelineTitle+g,a.trigger("core.system",{type:"system",status:"offline",data:e}))},b=function(e,t){e.content="暂时无法转接人工客服",c.setCurrentState("robot"),a.trigger("core.system",{type:"system",status:"blacklist",data:e})},w=function(e,n,o){var o=!!o;d(t,n).then(function(n,i){$.ajax({url:"/chat/user/chatconnect.action",type:"post",dataType:"json",data:{sysNum:t.sysNum,uid:t.apiInit.uid,way:1,groupId:e},success:function(e){2==e.status?j(e,o,n):0==e.status?v(e,o,n):1==e.status?(o?p(n,e,t.apiConfig.adminHelloWord):(a.trigger("core.system",{type:"system",status:"transfer",data:{content:"您好，客服"+e.aname+"接受了您的请求"}}),e.content=t.apiConfig.adminHelloWord,a.trigger("core.system",{type:"human",status:"transfer",data:e})),s&&s.destroy(),s=new u(e.puid),s.start(),c.setCurrentState("human"),a.trigger("core.buttonchange",{type:"transfer",action:"hide"})):3==e.status&&b(e,o)},fail:function(){}})})},k=function(e,s,n){var n=!!n,s=new o;return l(t,s).then(function(){w(null,null,n)},h),s},x=function(){},I=function(){a.on("sendArea.artificial",k),a.on("core.onreceive",y)},C=function(){var e=t.apiInit.ustatus;0==e||1==e||-2==e?k(null,null,!0):-1==e&&d(t).then(m)},T=function(){x(),I(),C()};T(),this.getWelcome=function(){}};t.exports=n},{"../socket/robot.js":12,"../socket/rolling.js":13,"../socket/socketfactory.js":14,"../socket/websocket.js":15,"../util/date.js":16,"../util/listener.js":17,"../util/promise.js":18,"./currentState.js":3,"./initsession.js":6,"./transfer.js":11}],5:[function(e,t,s){function n(t){var s=e("../util/listener.js"),n=e("../util/promise.js"),a=e("../util/date.js"),o=e("../socket/robot.js"),i=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js")),r=e("./initsession.js"),c=e("../socket/socketfactory.js"),u=t.apiConfig.leaveMsg,l=null,d=function(e,n,o){var i=o?n.aface:t.apiConfig.robotLogo,r=o?n.aname:t.apiConfig.robotName,o=o||t.apiConfig.robotHelloWord;e||(e=[]);var c=new Date,u={date:a.formatDate(c),content:[{senderType:o?2:1,t:+c,msg:o,ts:a.formatDate(c,!0),senderFace:i,senderName:r}]};e.push(u),setTimeout(function(){s.trigger("core.initsession",e)},0)},f=function(e,s,a){var a=!!a,s=new n;return i(t,s).then(function(){v(null,null,a)},g),s},g=function(){var e=[],n=new Date,i={date:a.formatDate(n),content:[{senderType:1,t:+n,msg:t.apiConfig.robotHelloWord,ts:a.formatDate(n,!0),senderFace:t.apiConfig.robotLogo,senderName:t.apiConfig.robotName}]};e.push(i),l=new o(t),modeState.setCurrentState("robot"),setTimeout(function(){s.trigger("core.initsession",e),s.trigger("core.sessionclose",-1)},0)},p=function(e,t,n){var a="排队中，您在队伍中的第"+e.count+"个，请等待。";t?(d(n,e,null),setTimeout(function(){e.content=a+" "+u,s.trigger("core.system",{type:"system",status:"queue",data:e}),s.trigger("core.sessionclose",-1)},1)):(e.content=a+" "+u,s.trigger("core.system",{type:"system",status:"queue",data:e}),s.trigger("core.sessionclose",-1))},m=function(e,n,a){l&&l.destroy(),l=new o(t),modeState.setCurrentState("robot"),s.trigger("core.buttonchange",{type:"transfer",action:"show"}),n?(d(a,e,null),setTimeout(function(){e.content=t.apiConfig.adminNonelineTitle+u,s.trigger("core.system",{type:"system",status:"offline",data:e}),s.trigger("core.sessionclose",-1)},1)):(e.content=t.apiConfig.adminNonelineTitle+u,s.trigger("core.system",{type:"system",status:"offline",data:e}),s.trigger("core.sessionclose",-1))},h=function(e,t){e.content="暂时无法转接人工客服",s.trigger("core.system",{type:"system",status:"blacklist",data:e}),s.trigger("core.sessionclose",-1)},v=function(e,n,a){var a=!!a;r(t,n).then(function(n,o){$.ajax({url:"/chat/user/chatconnect.action",type:"post",dataType:"json",data:{sysNum:t.sysNum,uid:t.apiInit.uid,way:1,groupId:e},success:function(e){2==e.status?m(e,a,n):0==e.status?p(e,a,n):1==e.status?(a?d(n,e,t.apiConfig.adminHelloWord):(s.trigger("core.system",{type:"system",status:"transfer",data:{content:"您好，客服"+e.aname+"接受了您的请求"}}),e.content=t.apiConfig.adminHelloWord,s.trigger("core.system",{type:"human",status:"transfer",data:e})),l&&l.destroy(),l=c(e,t),modeState.setCurrentState("human"),l.start(),s.trigger("core.buttonchange",{type:"transfer",action:"hide"})):3==e.status&&h(e,a)},fail:function(){}})})},y=function(){},j=function(){},b=function(){var e=t.apiInit.ustatus;0!=e&&1!=e&&-2!=e||f(null,null,!0)},w=function(){y(),j(),b()};w()}t.exports=n},{"../socket/robot.js":12,"../socket/rolling.js":13,"../socket/socketfactory.js":14,"../socket/websocket.js":15,"../util/date.js":16,"../util/listener.js":17,"../util/promise.js":18,"./initsession.js":6,"./transfer.js":11}],6:[function(e,t,s){var n=function(t,s){var n=e("../util/promise.js"),s=s||new n;return 0==t.apiInit.ustatus?setTimeout(function(){s.resolve([])},0):$.ajax({type:"post",url:"/chat/user/getChatDetailByCid.action",dataType:"json",data:{cid:t.apiInit.cid,uid:t.apiInit.uid},success:function(e){s.resolve(e)}}),s};t.exports=n},{"../util/promise.js":18}],7:[function(e,t,s){function n(t){var s=3,n=4,o=1,i=2,r=e("./humanfirst.js"),c=e("./robotfirst.js"),u=e("./robotonly.js"),l=e("./humanonly.js");if(a)return a;switch(t.apiConfig.type){case s:a=new c(t);break;case n:a=new r(t);break;case o:a=new u(t);break;case i:a=new l(t)}return a}var a=null;t.exports=n},{"./humanfirst.js":4,"./humanonly.js":5,"./robotfirst.js":8,"./robotonly.js":9}],8:[function(e,t,s){var n=function(t){var s,n,a=e("../util/listener.js"),o=e("../util/promise.js"),i=e("../util/date.js"),r=e("../socket/robot.js"),c=e("./currentState.js"),u=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js")),l=e("./initsession.js"),d=e("../socket/socketfactory.js"),f=t.apiConfig.leaveMsg,g=(new o,function(){$transferBtn=$(".temp_test")}),p=function(e,s){var s=s||new o;return l(t,s).then(function(e,s){e||(e=[]);var n=new Date,o={date:i.formatDate(n),content:[{senderType:1,t:+n,msg:t.apiConfig.robotHelloWord,ts:i.formatDate(n,!0),senderFace:t.apiConfig.robotLogo,senderName:t.apiConfig.robotName}]};return e.push(o),setTimeout(function(){a.trigger("core.initsession",e)},0),s}),s},m=function(e,s){var n=e?s.aface:t.apiConfig.robotLogo,o=e?s.aname:t.apiConfig.robotName,e=e||t.apiConfig.robotHelloWord;l(t).then(function(t,s){t||(t=[]);var r=new Date,c={date:i.formatDate(r),content:[{senderType:e?2:1,t:+r,msg:e,ts:i.formatDate(r,!0),senderFace:n,senderName:o}]};return t.push(c),setTimeout(function(){a.trigger("core.initsession",t)},0),s})},h=function(e,s){s?(m(null,e),setTimeout(function(){e.content=t.apiConfig.adminNonelineTitle+f,a.trigger("core.system",{type:"system",status:"offline",data:e})},1)):(e.content=t.apiConfig.adminNonelineTitle+f,a.trigger("core.system",{type:"system",status:"offline",data:e})),c.setCurrentState("robot")},v=function(e,o){var i="排队中，您在队伍中的第"+e.count+"个，请等待 ";n||(n=d(e,t),n.start()),s&&s.destroy(),s=new r(t),o?(m(null,e),setTimeout(function(){e.content=i+" "+f,a.trigger("core.system",{type:"system",status:"queue",data:e})},1)):(e.content=i+" "+f,a.trigger("core.system",{type:"system",status:"queue",data:e})),c.setCurrentState("robot")},y=function(e,n){s&&s.destroy(),s=d(e,t),s.start(),c.setCurrentState("human"),n?m(t.apiConfig.adminHelloWord,e):(a.trigger("core.system",{type:"system",status:"transfer",data:{content:"您好，客服"+e.aname+"接受了您的请求"}}),e.content=t.apiConfig.adminHelloWord,a.trigger("core.system",{type:"human",data:e})),a.trigger("core.buttonchange",{type:"transfer",action:"hide"})},j=function(e,t){e.content="暂时无法转接人工客服",a.trigger("core.system",{type:"system",status:"blacklist",data:e})},b=function(e,s){var s=!!s;u(t).then(function(e,n){$.ajax({url:"/chat/user/chatconnect.action",type:"post",dataType:"json",data:{sysNum:t.sysNum,uid:t.apiInit.uid,way:1,groupId:e||""},success:function(e){2==e.status?h(e,s):0==e.status?v(e,s):1==e.status?y(e,s):3==e.status&&j(e,s)},fail:function(){}})})},w=function(e,n){e||(e=[]);var o=new Date,u={date:i.formatDate(o),content:[{senderType:1,t:+o,msg:t.apiConfig.robotHelloWord,ts:i.formatDate(o,!0),senderFace:t.apiConfig.robotLogo,senderName:t.apiConfig.robotName}]};e.push(u),setTimeout(function(){a.trigger("core.initsession",e)},0),s=new r(t),c.setCurrentState("robot")},k=function(e){for(var o=e.list||[],i=0,r=o.length;r>i;i++){var u=o[i],l=u;if(200===u.type){s&&s.destroy(),s=n,n=null,c.setCurrentState("human"),a.trigger("core.system",{type:"system",status:"transfer",data:{content:"您好，客服"+l.aname+"接受了您的请求"}}),l.content=t.apiConfig.adminHelloWord,a.trigger("core.system",{type:"human",data:l}),a.trigger("core.buttonchange",{type:"transfer",action:"hide"});break}}},x=function(){a.on("sendArea.artificial",b),a.on("core.onreceive",k)},I=function(){a.trigger("core.buttonchange",{type:"transfer",action:"show"});var e=t.apiInit.ustatus;0==e?(s=new r(t),p(),c.setCurrentState("robot")):1==e||-2==e?b(null,!0):-1==e&&l(t).then(w)},C=function(){g(),x(),I()};C()};t.exports=n},{"../socket/robot.js":12,"../socket/rolling.js":13,"../socket/socketfactory.js":14,"../socket/websocket.js":15,"../util/date.js":16,"../util/listener.js":17,"../util/promise.js":18,"./currentState.js":3,"./initsession.js":6,"./transfer.js":11}],9:[function(e,t,s){var n=function(t){var s=e("../util/listener.js"),n=e("../util/promise.js"),a=e("../util/date.js"),o=e("../socket/robot.js"),i=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js"),e("./initsession.js")),r=(e("../socket/socketfactory.js"),function(e,o){var o=o||new n;return i(t,o).then(function(e,n){e||(e=[]);var o=new Date,i={date:a.formatDate(o),content:[{senderType:1,t:+o,msg:t.apiConfig.robotHelloWord,ts:a.formatDate(o,!0),senderFace:t.apiConfig.robotLogo,senderName:t.apiConfig.robotName}]};return e.push(i),setTimeout(function(){s.trigger("core.initsession",e)},0),n}),o}),c=function(e,n){e||(e=[]);var o=new Date,i={date:a.formatDate(o),content:[{senderType:1,t:+o,msg:t.apiConfig.robotHelloWord,ts:a.formatDate(o,!0),senderFace:t.apiConfig.robotLogo,senderName:t.apiConfig.robotName}]};e.push(i),setTimeout(function(){s.trigger("core.initsession",e)},0)},u=function(){},l=function(){},d=function(){setTimeout(function(){s.trigger("core.buttonchange",{type:"transfer",action:"hide"})},5);var e=t.apiInit.ustatus;0==e?(manager=new o(t),modeState.setCurrentState("robot"),r()):-1==e&&(manager=new o(t),modeState.setCurrentState("robot"),i(t).then(c))},f=function(){u(),l(),d()};f()};t.exports=n},{"../socket/robot.js":12,"../socket/rolling.js":13,"../socket/socketfactory.js":14,"../socket/websocket.js":15,"../util/date.js":16,"../util/listener.js":17,"../util/promise.js":18,"./initsession.js":6,"./transfer.js":11}],10:[function(e,t,s){var n={},a='<div class="shadow-layer"><div class="group-outer"><div class="group-title">选择咨询内容</div><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.groupId}}">{{=item.recGroupName}}</li>{{  } }}</ul></div><div class="group-footer js-cancel-btn">取消</div></div></div>';n.groupTemplate=a,t.exports=n},{}],11:[function(e,t,s){function n(t,s){var n=e("../util/promise.js"),s=s||new n,a=e("./template.js"),o=function(e){var t=doT.template(a.groupTemplate)({list:e}),n=$(t);$(".js-wrapBox").append(n),n.delegate(".js-item","click",function(e){var t=e.currentTarget,a=$(t).attr("data-id");s.resolve(a),n.remove()}),n.find(".js-cancel-btn").on("click",function(){s.reject(),n.remove()})},i=function(){if(0!==t.apiInit.ustatus)setTimeout(function(){s.resolve(null)},0);else if(0===t.apiConfig.groupflag)setTimeout(function(){s.resolve(null)},0);else if(t.urlParams.groupId&&t.urlParams.groupId.length){var e=t.urlParams.groupId;setTimeout(function(){s.resolve(e)},0)}else $.ajax({url:"/chat/user/getGroupList.action",dataType:"json",type:"get",data:{companyId:t.apiInit.pid},success:function(e){if(1==e.length){var n=e[0];t.urlParams.groupId=n.groupId,s.resolve(n.groupId)}else o(e)},fail:function(){}})};return i(),s}t.exports=n},{"../util/promise.js":18,"./template.js":10}],12:[function(e,t,s){function n(t){var s=e("../util/listener.js"),n="robot",a=!1,o=function(){},i=function(e){return e.uid+""+e.date},r=function(e){var o=e[0];if("robot"===o.currentStatus){var r=(i(o),o.answer.replace(/(^\s+|\s+$)/g,""));/^\d+$/.test(r)||(a=!1),"question"==o.requestType&&(a=!0),$.ajax({url:"/chat/user/robotsend.action",data:"type",data:{requestText:o.answer,question:o.answer,sysNum:t.sysNum,uid:t.apiInit.uid,cid:t.apiInit.cid,source:t.userInfo.source,questionFlag:a?1:0},type:"post",success:function(e){var t=JSON.parse(e);4==t.answerType&&(a=!0),s.trigger("core.onreceive",{list:[t],type:n})},fail:function(e){}}),a=!1}},c=function(){s.off("sendArea.send",r)},u=function(){s.on("sendArea.send",r)},l=function(){o(),u()};this.destroy=c,l()}t.exports=n},{"../util/listener.js":17}],13:[function(e,t,s){function n(t,s,n){this.puid=t;var a,o=e("../util/listener.js"),i="human",r=function(e,s){var s=s||0,n=e[0];"human"===n.currentStatus&&(n.date?n.ts=n.date:n.ts=+new Date,$.ajax({url:"/chat/user/chatsend.action",data:{puid:t,cid:n.cid,uid:n.uid,content:n.answer},dataType:"json",type:"POST",success:function(e){o.trigger("core.msgresult",{msgId:n.dateuid,result:"success"})},error:function(e){s>=3?o.trigger("core.msgresult",{msgId:n.dateuid,result:"fail"}):setTimeout(function(){r([n],s+1)},1e3)}}))},c=function(){clearInterval(a)},u=function(){$.ajax({url:"/chat/user/msg.action",dataType:"json",data:{puid:t},type:"get",success:function(e){if(e&&e.length){for(var t=[],s=0,n=e.length;n>s;s++){var a=JSON.parse(e[s]);t.push(a),204===a.type&&(o.trigger("core.sessionclose",a.status),2==a.status&&o.trigger("core.system",{type:"system",status:"kickout",data:{content:"您与客服"+a.aname+"的会话已经关闭"}}))}o.trigger("core.onreceive",{type:i,list:t})}},fail:function(){}}),a=setTimeout(u,1500)},l=function(){o.on("sendArea.send",r)},d=function(){l()};d(),this.destroy=c,this.start=u}t.exports=n},{"../util/listener.js":17}],14:[function(e,t,s){var n=null,a=function(t,s){if(n)return n;var a=(e("../socket/websocket.js"),e("../socket/rolling.js"));return window.WebSocket,n=new a(t.puid,t.pu,s)};t.exports=a},{"../socket/rolling.js":13,"../socket/websocket.js":15}],15:[function(e,t,s){function n(t,s,n){this.puid=t;var a,s=n.apiConfig.websocketUrl,o="human",i=e("../util/listener.js"),r=5e3,c=0,u={},l=function(){var e=+new Date;for(var t in u){var s=u[t];e-s.sendTime>=r&&(delete u[t],i.trigger("core.msgresult",{msgId:s.dateuid,result:"fail"}))}},d=function(e){var t;Object.prototype.toString.call(e).indexOf("Array")>=0&&(t=e[0]),"human"===t.currentStatus&&(t.date?t.ts=e.date:t.ts=+new Date,t.type=103,t.msgId=t.dateuid,t.sendTime=t.date,t.content=t.answer,t.uname=n.userInfo.uname,t.face=n.userInfo.face,u[t.msgId]=t,a.send(JSON.stringify(t)))},f=function(e){i.trigger("core.msgresult",{msgId:e.msgId,result:"success"}),delete u[e.msgId]},g=function(e){i.trigger("core.onreceive",{type:o,list:[e]})},p=function(e){204==e.type&&(i.trigger("core.sessionclose",e.status),2==e.status&&i.trigger("core.system",{type:"system",status:"kickout",data:{content:"您与客服"+e.aname+"的会话已经关闭"}})),i.trigger("core.onreceive",{type:o,list:[e]})},m=function(e){var t=JSON.parse(e.data);301==t.type?f(t):202==t.type?g(t):p(t)},h=function(){console.log("websocket closed")},v=function(){a.onopen=function(){var e={t:c,u:n.apiInit.uid,s:n.sysNum};a.send(JSON.stringify(e)),setInterval(l,1e3)},a.onclose=function(){h()},a.onmessage=m,i.on("sendArea.send",d)},y=function(){v()},$=function(){},j=function(){a=new WebSocket(s),y()},b=function(){};this.destroy=$,this.start=j,this.stop=b}t.exports=n},{"../util/listener.js":17}],16:[function(e,t,s){var n={},a=function(e){return e>=10?e+"":"0"+e},o=function(e){var t=a,s=e.getHours(),n=e.getMinutes(),o=e.getSeconds(),i=[t(s),t(n),t(o)];return i.join(":")},i=function(e,t){var s=a,n=e.getFullYear(),i=e.getMonth()+1,r=e.getDate(),c=[s(n),s(i),s(r)],u=e.getHours(),l=e.getMinutes(),d=e.getSeconds();[s(u),s(l),s(d)];return c.join("-")+(t?"":" "+o(e))};n.formatTime=o,n.formatDate=i,t.exports=n},{}],17:[function(e,t,s){var n={},a={},o=function(e,t){if(a[e])for(var s=0,n=a[e].length;n>s;s++){var o=a[e][s];o(t)}},i=function(e,t){a[e]||(a[e]=[]);for(var s=!1,n=a[e],o=0,i=n.length;i>o;o++)if(n[o]==t){s=!0;break}s||a[e].push(t)},r=function(e,t){if(t&&"function"==typeof t){var s=a[e];if(s&&s.length)for(var n=s.length,o=n-1;o>=0;o--){var i=s[o];if(i==t){s.splice(o,1);break}}}else delete a[e]};n.on=i,n.off=r,n.trigger=o,t.exports=n},{}],18:[function(e,t,s){function n(){var e=[];this.resolve=function(t){var s=e.shift();s&&s.success&&"function"==typeof s.success&&s.success(t,this)},this.reject=function(t){var s=e.shift();s&&s.fail&&"function"==typeof s.fail&&s.fail(t,this)},this.then=function(t,s){return e.push({success:t,fail:s}),this}}n.when=function(e){return e()},t.exports=n},{}],19:[function(e,t,s){var n=function(t){var s,n,a=e("../../../common/initConfig.js")(),o=e("../../../common/mode/mode.js"),i=e("../../../common/util/listener.js"),r=function(){},c=function(){i.on("system.send",function(e){})},u=function(){s=o(n)},l=function(){r(),c(),u()};a.then(function(e){$(".white-layer").remove(),$(document.body).trigger("core.onload",[{data:e}]),n=e,l(),i.trigger("core.onload",[n])})};t.exports=n},{"../../../common/initConfig.js":2,"../../../common/mode/mode.js":7,"../../../common/util/listener.js":17}],20:[function(e,t,s){!function(t){var s=(e("./core/core.js")(window),e("./listMsg/main.js")),n=e("./sendArea/index.js");e("./fun/closesession.js");var a=function(){},o=function(){s(),n(window)},i=function(){a(),o()};i()}(document.body)},{"./core/core.js":19,"./fun/closesession.js":21,"./listMsg/main.js":22,"./sendArea/index.js":27}],21:[function(e,t,s){!function(){var t=e("../../../common/util/listener.js"),s=function(){t.on("core.sessionclose",function(e){var t=e;switch(t){case-1:alert("仅人工模式，转人工失败");break;case 1:alert("客服自己离线了");break;case 2:alert("客服把你踢了");break;case 3:alert("客服把你拉黑了");break;case 4:alert("长时间不说话");break;case 6:alert("有新窗口打开")}})},n=function(){s()};n()}()},{"../../../common/util/listener.js":17}],22:[function(e,t,s){var n=function(){var t,s,n,a,o,i,r,c,u,l,d,f,g=!0,p=e("../../../common/comm.js"),m=e("../../../common/util/listener.js"),h=e("./template.js"),v=(e("../../../common/mode/mode.js"),e("../../../common/util/promise.js"),e("./theme.js")),y=e("./scroll.js"),j=e("../util/qqFace.js")(),b={},w={},k=[],x=[],I=[],C=["queue","offline","blacklist"],T={MSG_LOADING:"msg-loading",MSG_LSSUED:"msg-lssued",MSG_SERVED:"msg-served",MSG_FAIL:"msg-fail"},L={L0001:"您与{0}的会话已经结束",L0002:"您已经很长时间未说话了哟，有问题尽管咨询",L0003:"您已在新窗口打开聊天页面",L0004:"客服正在输入..."},A=function(e,s){var a,o=e.length,i="",r=0,c="",u="",l="",d="",f=/target="_self"/g;if(e&&e.length>0){for(var g=0;o>g;g++){i=e[g].content,r=i.length;for(var m=0;r>m;m++){c=i[m];var v,y=c.msg.indexOf("uploadedFile");v=y>=0||c.msg.indexOf("<")>=0&&c.msg.indexOf(">")>=0?c.msg:p.getNewUrlRegex(c.msg),0===c.senderType?(a=$.extend({userLogo:c.senderFace,userMsg:j.analysis(v),date:c.t,msgLoading:T.MSG_SERVED}),u=doT.template(h.rightMsg)(a)):(console.log(c),c.sdkMsg&&"4"==c.sdkMsg.answerType?u=b.sugguestionsSearch(c.sdkMsg,!0):(a=$.extend({customLogo:"null"!==c.senderFace?c.senderFace:t.apiConfig.robotLogo,customName:c.senderName,customMsg:v,date:c.t}),u=doT.template(h.leftMsg)(a)));var k=new Date,x=Math.abs(k-new Date(c.ts.substr(0,c.ts.indexOf(" "))))/1e3/60/60/24;if(l){var I=Math.abs(new Date(l)-new Date(c.ts))/1e3/60;if(Number(I)>1){var C;C=1>=x?0:x>1&&2>=x?1:2;var L=w.getTimeLine(C,c.ts);u+=L?L:""}}l=c.ts,d=(d+u).replace(f,'target="_blank"')}}S(d,!0)}else t.flags.moreHistroy=!1;n.scroll.refresh(),s&&n.scroll.scrollTo(0,n.scroll.maxScrollY)},S=function(e,t){var s=d,n="";t&&(n=s.children(),n&&n.length?d.children().first().before(e):d.append(e))},q=function(){n.scroll.on("slideDown",M),t.flags.moreHistroy=!0},M=function(){n.pullDown(function(e){e.length>0?(A(e),setTimeout(function(){$(l).removeClass("loading"),$(l).text("下拉加载更多")},100),t.flags.moreHistroy=!0):t.flags.moreHistroy=!1})},D=function(e,o){var i,r="";if(o){switch(e){case 0:var c=p.getNewUrlRegex(o[0].answer.trim()),u=1==s?T.MSG_SERVED:T.MSG_LOADING;2==s&&k.push(o[0].dateuid),i=$.extend({userLogo:t.userInfo.face,userMsg:j.analysis(c),date:o[0].date,msgId:o[0].dateuid,msgLoading:u}),r=doT.template(h.rightMsg)(i);break;case 1:console.log(o);for(var l=o.type,d=o.list,f=0;f<d.length;f++){var g=d[f];"robot"==l?r+="4"==g.answerType?b.sugguestionsSearch(g,!1):b.onMsgFromCustom("robot",g):202==g.type?r+=b.onMsgFromCustom("human",g):204==g.type?r+=b.sessionCloseHander(g):205==g.type&&(r+=w.onSysMsgShow(L.L0004,g.type))}break;case 2:var l=o.type,g=o.data;"system"==l?r=w.onSysMsgShow(g.content,o.status):(s="robot"==l?1:2,r=b.onMsgFromCustom(l,g));break;case 3:i=$.extend({sysData:o,date:+new Date}),r=doT.template(h.sysData)(i);break;case 4:a=o[0].token,k.push(a),i=$.extend({userLogo:t.userInfo.face,uploadImg:o[0].result,progress:0,token:o[0].token,date:o[0].date}),r=doT.template(h.rightImg)(i)}b.updateChatMsg(r),n.scroll.refresh(),n.scroll.scrollTo(0,n.scroll.maxScrollY)}};w={nowTimer:function(){var e=new Date,t=e.getHours()>=10?e.getHours():"0"+e.getHours(),s=e.getMinutes()>=10?e.getMinutes():"0"+e.getMinutes(),n="今天"+t+":"+s;D(3,n)},getTimeLine:function(e,t){var s;if(2==e)s=t.substring(0,t.lastIndexOf(":"));else{var n=0===e?"今天":"昨天";s=n+t.substring(t.indexOf(" "),t.lastIndexOf(":"))}var a=$.extend({sysData:s,date:+new Date}),o=doT.template(h.sysData)(a);return s?o:void 0},onAutoSize:function(e){clearInterval(o),o=setTimeout(function(){
var t=e.offset().top-$(i).height();$(u).height(t),n.scroll.refresh(),n.scroll.scrollTo(0,n.scroll.maxScrollY),$(window).scrollTop(Number($("#js-textarea").offset().top))},300)},onSessionOpen:function(e){D(2,e)},onSysMsgShow:function(e,t){var s=+new Date,n=$.extend({sysMsg:e,sysMsgSign:s,date:s});C.indexOf(t)>=0?I.push(s):205==t&&x.push(s);var a=doT.template(h.sysMsg)(n);return a},onBeingInput:function(){setInterval(function(){var e=x.shift();$("#"+e).remove(),n.scroll.refresh()},5e3)}},b={sugguestionsSearch:function(e,s){if(e){var n=e.sugguestions,a=$.extend({customLogo:t.apiConfig.robotLogo,customName:t.apiConfig.robotName,list:n,isHistory:s,stripe:e.stripe}),o=doT.template(h.listSugguestionsMsg)(a);return o}return"非常对不起哦，不知道怎么回答这个问题呢，我会努力学习的。"},onSend:function(e){if(a){var t=$("#img"+a);t.find("p img:first-child").remove(),t.find("p").html(e[0].answer),a=""}else if(e[0].sendAgain){console.log(e);var s=$("#userMsg"+e[0].oldMsgId).parents("div.rightMsg");d.append(s)}else D(0,e)},onReceive:function(e){"robot"===e.type?s=1:"human"===e.type&&(s=2),D(1,e)},onSugguestionsEvent:function(){var e=$(this).text();if(e){var s=e.substr(e.indexOf(":")+1,e.length).trim();m.trigger("sendArea.send",[{answer:s,uid:t.apiConfig.uid,cid:t.apiConfig.cid,currentState:"robot",requestType:"question",date:t.apiConfig.uid+new Date}])}},onUpLoadImg:function(e){D(4,e)},onUpLoadImgProgress:function(e){var t,s,o;g&&(t=$("#img"+a).find(".js-shadowLayer"),s=$("#progress"+a),o=t.height(),g=!1),s.text(e+"%");var i=e/100,r=i*o,c=o-r;t.height(c),i>=1&&(g=!0,t.remove(),s.remove(),n.scroll.refresh())},getHello:function(e){e&&e.length&&(s=e[e.length-1].content[0].senderType),A(e,1)},updateChatMsg:function(e){if(d&&d.children().length){var t=d.children().last(),s=Math.abs(new Date-new Date(Number(t.attr("date"))))/1e3/60;if(s>1&&!t.hasClass("sysData")){var n=new Date,a=n.getHours()>=10?n.getHours():"0"+n.getHours(),o=n.getMinutes()>=10?n.getMinutes():"0"+n.getMinutes(),i="今天 "+a+":"+o,r=$.extend({sysData:i,date:+new Date});e=doT.template(h.sysData)(r)+e}}if(d.append(e),I.length>1){var c=I.shift();$("#"+c).animate({"margin-top":"-50px",opacity:"0.1"},500,function(){$(this).remove()})}},sessionCloseHander:function(e){var t="";if(e)switch(e.status){case 1:t=p.format(L.L0001,[e.aname],!0);break;case 2:t=p.format(L.L0001,[e.aname],!0);break;case 3:t=p.format(L.L0001,[e.aname],!0);break;case 4:t=p.format(L.L0002,[e.aname],!1);break;case 6:t=p.format(L.L0003,[e.aname],!1)}var s=+new Date,n=$.extend({sysMsg:t,sysMsgSign:s,date:s});return doT.template(h.sysMsg)(n)},msgReceived:function(e){if(e&&e.msgId){var s=k.indexOf(e.msgId);s>=0&&("success"==e.result?(k.splice(s,1),$("#userMsg"+e.msgId).removeClass("msg-loading msg-fail").addClass("msg-served")):($("#userMsg"+e.msgId).removeClass("msg-loading").addClass("msg-fail"),$("#userMsg"+e.msgId).on("click",function(){$("#userMsg"+e.msgId).removeClass("msg-fail").addClass("msg-loading");var s;s=$(this).hasClass("msg")?$(this).prev().text().trim():$(this).prev().find("p").html(),m.trigger("sendArea.send",[{answer:s,uid:t.apiInit.uid,cid:t.apiInit.cid,dateuid:t.apiInit.uid+ +new Date,oldMsgId:e.msgId,date:+new Date,token:e.msgId,sendAgain:!0}])})))}},onMsgFromCustom:function(e,s){var n,a,o;"robot"==e?(console.log(s.answer),o=j.analysis(s.answer?s.answer:""),n=t.apiConfig.robotLogo,a=t.apiConfig.robotName):"human"==e&&(o=j.analysis(s.content?s.content:""),n=s.aface,a=s.aname);var i,r=o.indexOf("uploadedFile");i=r>=0||o.indexOf("<")>=0&&o.indexOf(">")>=0?o:p.getNewUrlRegex(o);var c=$.extend({customLogo:n,customName:a,customMsg:i,date:+new Date}),u=doT.template(h.leftMsg)(c);return u}};var N=function(e){t=e[0],O(),q(),m.on("sendArea.send",b.onSend),m.on("core.onreceive",b.onReceive),m.on("sendArea.createUploadImg",b.onUpLoadImg),m.on("sendArea.uploadImgProcess",b.onUpLoadImgProgress),m.on("core.initsession",b.getHello),m.on("sendArea.autoSize",w.onAutoSize),m.on("core.system",w.onSessionOpen),m.on("core.msgresult",b.msgReceived),$(".js-chatPanelList").delegate(".js-answerBtn","click",b.onSugguestionsEvent),$(".js-chatMsgList").on("click",function(){m.trigger("listMsg.hideKeyboard")})},O=function(){v(t,f),n=y(t,f),w.nowTimer(),w.onBeingInput()},F=function(){i=$(".js-header-back"),r=$(".js-userMsgOuter"),c=$(".js-chatMsgList"),u=$(".js-wrapper"),l=$(".js-pullDownLabel"),d=$(".js-chatPanelList"),f=$(".js-wrapBox")},H=function(){m.on("core.onload",N)},U=function(){F(),H()};U()};t.exports=n},{"../../../common/comm.js":1,"../../../common/mode/mode.js":7,"../../../common/util/listener.js":17,"../../../common/util/promise.js":18,"../util/qqFace.js":36,"./scroll.js":23,"./template.js":24,"./theme.js":25}],23:[function(e,t,s){var n=function(e,t){var s,n,a,o={},i={url_keepDetail:"/chat/user/getChatDetailByCid.action",url_detail:"/chat/user/chatdetail.action"},r=function(){a||(a=new IScroll(n[0],{probeType:3,tap:!0,click:!0,mouseWheel:!0,useTransition:!0,useTransform:!0,snap:!1,scrollbars:!1,bounce:!0,momentum:!0}))},c=function(){var t=a.y;a.maxScrollY-t;if(e.flags.moreHistroy){if(t>=40)return $(s).text("正在加载中..."),$(s).addClass("loading"),""}else $(s).text("没有更多消息"),$(s).removeClass("loading")};o.pullDown=function(t){a.y>40&&e.flags.moreHistroy&&(e.flags.pageNow+=1,$.ajax({type:"post",url:i.url_detail,dataType:"json",data:{uid:e.apiInit.uid,pageNow:e.flags.pageNow,pageSize:e.flags.pageSize},success:t}))};var u=function(){s=$(t).find(".js-pullDownLabel"),n=$(".js-wrapper")},l=function(){a.on("scroll",c)},d=function(){u(),r(),l()};return d(),o.scroll=a,o};t.exports=n},{}],24:[function(e,t,s){var n={},a='<div class="msgwrap leftMsg" date="{{=it.date}}"><div class="header"><img src="{{=it.customLogo}}" alt="" /></div><p class="r-name">{{=it.customName}}</p><div class="msgOuter"><p>{{=it.customMsg}}</p></div></div>',o='<div class="msgwrap leftMsg" date="{{=it.date}}"><div class="header"><img src="{{=it.customLogo}}" alt="" /></div><p class="r-name">{{=it.customName}}</p><div class="msgOuter"><p>{{=it.stripe}}</p><ul class="sugguestions">{{for(var i=0;i<it.list.length;i++){ }}{{if(it.isHistory){ }}<li><a href="#0" class="js-answerBtn" style="color:#596273">{{=it.list[i]}}</a></li>{{}else{}}<li><a href="#0" class="js-answerBtn" style="color:#596273" data-docid="{{=it.list[i]["docId"]}}">{{=i+1}}: {{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}</ul></div></div>',i='<div class="msgwrap rightMsg" date="{{=it.date}}"><div class="header"><img src="{{=it.userLogo}}" alt="" /></div><div class="msgOuter js-userMsgOuter"><p>{{=it.userMsg}}</p></div><span id="userMsg{{=it.msgId}}" class="msg js-msgStatus msgStatus statusRight {{=it.msgLoading}}"></span></div></div>',r='<div class="msgwrap rightMsg" date="{{=it.date}}"><div class="header"><img src="{{=it.userLogo}}" alt="" /></div><div id="img{{=it.token}}" class="msgOuter js-userMsgOuter"><p><img src="{{=it.uploadImg}}"</p><div class="shadowLayer js-shadowLayer"></div><div class="progressLayer"><span id="progress{{=it.token}}" class="progress js-progress">{{=it.progress}}</span></div></div><span id="userMsg{{=it.token}}" class="img js-msgStatus msgStatus statusRight {{=it.msgLoading}}"></span></div></div>',c='<p class="sysMsg" id={{=it.sysMsgSign}} date="{{=it.date}}"><span class="sysMsgText"> {{=it.sysMsg}}</span></p>',u='<p class="sysData" date="{{=it.date}}">{{=it.sysData}}</p>';n.leftMsg=a,n.rightMsg=i,n.rightImg=r,n.sysMsg=c,n.sysData=u,n.listSugguestionsMsg=o,t.exports=n},{}],25:[function(e,t,s){var n=function(e,t){var s,n,a,o,i,r=function(){e.userInfo.back&&1==e.userInfo.back?($(s).addClass("show"),$(a).addClass("addTop")):$(a).removeClass("addTop")},c=function(){var t=e.apiConfig.color;$(o).html(".rightMsg .msgOuter::before{border-color:transparent "+t+" !important} .rightMsg .msgOuter{background-color:"+t+" !important}.wrap .header-back{background-color:"+t+" !important}")},u=function(){var t=e.apiConfig.robotName;i.text(t)},l=function(){s=t.find(".js-header-back"),n=t.find(".js-userMsgOuter"),a=t.find(".js-wrapper"),o=$(".js-setStyle"),i=t.find(".js-title")},d=function(){r(),c(),u()},f=function(){l(),d()};f()};t.exports=n},{}],26:[function(e,t,s){function n(t){var s,n=e("./template.js"),s=e("../util/alert.js"),t=t,a=function(){$evaluate=$(".js-evaluate")},o=function(){$(this).addClass("active").siblings().removeClass("active")},r=function(){$(this).toggleClass("active")},c=function(){s=new s({title:"机器人是否解决了您的问题",okText:"是",cancelText:"否",OK:function(){}}),s.show()},u=function(){s.show();var e={},t=doT.template(n.sobotEvaluate_selfHtml)(e);s.setInner(t),$(".js-noques").addClass("active"),$(".js-isques").on("click",p),$(".wether span").on("click",o),$(".situation span").on("click",r)},l=function(){s=new s({title:"客服评价",footer:!1}),s.show();var e={},t=doT.template(n.humanOne_selfHtml)(e);s.setInner(t),$aLi=$("#star li");var a=0;for(i=1;i<=$aLi.length;i++)$aLi[i-1].index=i,$aLi[i-1].onmouseover=function(){f(this.index)},$aLi[i-1].onmouseout=function(){f(this.index)},$aLi[i-1].onclick=function(){switch(a=this.index){case 1:case 2:case 3:case 4:d(a);break;case 5:s.hide(),alert("感谢您的反馈")}}},d=function(e){s.show();var t={},a=doT.template(n.humanTwo_selfHtml)(t);for(s.setInner(a),$aLi=$("#star li"),i=1;i<=$aLi.length;i++)f(e),$aLi[i-1].index=i,$aLi[i-1].onmouseover=function(){f(this.index)},$aLi[i-1].onmouseout=function(){f(this.index)},$aLi[i-1].onclick=function(){switch(e=this.index){case 5:s.hide(),alert("感谢您的反馈")}};$(".js-noques").addClass("active"),$(".js-isques").on("click",p),$(".wether span").on("click",o),$(".situation span").on("click",r)},f=function(e){for(var t=0;t<$aLi.length;t++)$aLi[t].className=e>t?"on":""},g=function(){s.show()},p=function(){s.hide()},m=function(){$(".js-noques").on("click",u),$(".js-isques").on("click",p)},h=function(){$(".js-noques").on("click",d),$(".js-isques").on("click",p)},v=function(){a(),1==t?(c(),m()):(l(),h())};v(),this.modeAlert=g}t.exports=n},{"../util/alert.js":31,"./template.js":29}],27:[function(e,t,s){function n(t){var s,s,n,a,o,i,r=e("../../../common/util/listener.js"),c=e("../util/qqFace.js")(),u=(e("./uploadImg.js")(),e("./placeholder.js")),l=e("./evaluate.js"),d=1,f=function(e){i=e,"human"==i?u($textarea,"当前是人工"):"robot"==i&&u($textarea,"当前是机器人")},g=function(e){"hide"==e.action?(d=2,$(".qqFaceTip").css("display","inline-block"),$uploadImg.show(),$satisfaction.show(),$artificial.hide(),u($textarea,"当前是人工")):(d=1,$uploadImg.hide(),$satisfaction.show(),$artificial.show())},p=function(e){1==d?m():h()},m=function(){var e=$textarea.text();e?($sendBtn.css("display","inline-block"),$add.hide(),b(),$textarea.css("width","78%")):($sendBtn.hide(),b(),$(".add").css("display","inline-block"),$textarea.css("width","83%")),"js-textarea"==document.activeElement.id&&(o=!0)},h=function(){var e=$textarea.text();e?($sendBtn.css("display","inline-block"),$add.hide(),$textarea.css("width","67%")):($sendBtn.hide(),b(),$(".add").css("display","inline-block"),$textarea.css("width","83%"),$textarea.blur(),$textarea.focus()),"js-textarea"==document.activeElement.id&&(o=!0)},v=function(e){var t=$textarea.text();if(0==t.length||/^\s+$/g.test(t))return $textarea.html(""),!1;_html=c.analysis(t);var s=a+ +new Date;r.trigger("sendArea.send",[{answer:t,uid:a,cid:n,dateuid:s,date:+new Date,token:"",sendAgain:!1,currentStatus:i}]),$textarea.html(""),1==o?($textarea.blur(),$textarea.focus()):$(".add").css("display","inline-block"),$sendBtn.hide(),1==d?$textarea.css("width","83%"):$textarea.css("width","75%"),T()},y=function(){$chatArea.hasClass("showChatAdd")?(b(),1==d?($(".addhover").hide(),$(".add").css("display","inline-block"),$(".qqFaceTiphover").hide(),$(".qqFaceTip").hide()):($(".addhover").hide(),$(".add").css("display","inline-block"),$(".qqFaceTiphover").hide(),$(".qqFaceTip").css("display","inline-block"))):setTimeout(function(){$chatArea.addClass("showChatAdd"),$chatArea.removeClass("showChatEmotion"),$chatAdd.show(),$chatEmotion.hide(),$chatArea.removeClass("hideChatArea").addClass("showChatArea"),1==d?($(".qqFaceTiphover").hide(),$(".qqFaceTip").hide(),$(".addhover").css("display","inline-block"),$(".add").hide()):($(".addhover").css("display","inline-block"),$(".add").hide(),$(".qqFaceTiphover").hide(),$(".qqFaceTip").css("display","inline-block")),T()},200),o=!1},j=function(){$chatArea.hasClass("showChatEmotion")?b():setTimeout(function(){if($chatArea.addClass("showChatEmotion"),$chatArea.removeClass("showChatAdd"),$chatAdd.hide(),$chatEmotion.css("display","inline-block"),$chatArea.removeClass("hideChatArea").addClass("showChatArea"),1==d)$(".qqFaceTiphover").hide(),$(".qqFaceTip").hide(),$(".addhover").hide(),$(".add").css("display","inline-block");else{var e=$textarea.text();$(".qqFaceTiphover").css("display","inline-block"),$(".qqFaceTip").hide(),$(".addhover").hide(),e?($add.hide(),$sendBtn.css("display","inline-block")):($(".add").css("display","inline-block"),$sendBtn.hide())}T()},200),o=!1},b=function(){$chatArea.removeClass("showChatAdd"),$chatArea.removeClass("showChatEmotion"),$chatArea.removeClass("showChatArea").addClass("hideChatArea"),T();var e=$textarea.text();1==d?($(".qqFaceTiphover").hide(),$(".qqFaceTip").hide(),$(".addhover").hide(),e?($add.hide(),$sendBtn.css("display","inline-block")):($(".add").css("display","inline-block"),$sendBtn.hide())):($(".qqFaceTiphover").hide(),$(".qqFaceTip").css("display","inline-block"),$(".addhover").hide(),e?($add.hide(),$sendBtn.css("display","inline-block")):($(".add").css("display","inline-block"),$sendBtn.hide())),o=!1},w=function(){var e=$(this).attr("data-id");$(e).show()},k=function(e){var t=e[0].answer,s=$textarea.html()+t;$textarea.html(s),u($textarea,"当前是人工"),h(),T()},x=function(){var e=$textarea.text();e=1==e.length?"":$.trim(e.substring(0,e.length-1)),$textarea.text(e),h(),T(),o=!1},I=function(e){var t='<img class="webchat_img_upload" src="'+e[0].url+'">';r.trigger("sendArea.send",[{answer:t,uid:a,cid:n,dateuid:e[0].token,date:e[0].date,token:e[0].token,sendAgain:!1,currentStatus:i}]),o=!1},C=function(){r.trigger("sendArea.artificial"),o=!1},T=function(){r.trigger("sendArea.autoSize",$chatArea)},L=function(e){switch(e){case 1:case 2:case 3:case 4:case 6:$chatArea.removeClass("hideChatArea").addClass("showChatArea"),$keepSession.hide(),$endSession.show(),T()}},A=function(){var e=+new Date;t.location.href=t.location.href+"&random="+e},S=function(){l(d),o=!1},q=function(){$textarea.blur(),$chatArea.removeClass("showChatArea").addClass("hideChatArea");var e=$textarea.text();1==d?e?($(".qqFaceTiphover").hide(),$(".addhover").hide(),$(".qqFaceTip").hide()):($(".qqFaceTiphover").hide(),$(".addhover").hide(),$(".add").css("display","inline-block"),$(".qqFaceTip").hide()):e?($(".qqFaceTiphover").hide(),$(".addhover").hide(),$(".qqFaceTip").css("display","inline-block")):($(".qqFaceTiphover").hide(),$(".addhover").hide(),$(".add").css("display","inline-block"),$(".qqFaceTip").css("display","inline-block")),o=!1,T()},M=function(){$chatArea=$(".js-chatArea"),$sendBtn=$(".js-sendBtn"),$textarea=$(".js-textarea"),$sendarea=$(".sendarea"),$artificial=$(".js-artificial"),$add=$(".js-add"),$chatAdd=$(".js-chatAdd"),$uploadImg=$(".js-uploadImg"),$emotion=$(".js-emotion"),$chatEmotion=$(".js-chatEmotion"),$tab=$(".js-tab"),$keepSession=$(".js-keepSession"),$endSession=$(".js-endSession"),$newMessage=$(".js-newMessage"),$satisfaction=$(".js-satisfaction")},D=function(){$sendBtn.on("click",v),$emotion.on("click",N),$textarea.on("keyup",p),$textarea.on("focus",b),$add.on("click",y),$emotion.on("click",j),$tab.on("click",w),r.on("sendArea.gotoxy",k),r.on("sendArea.backDelete",x),r.on("sendArea.uploadImgUrl",I),$(t).on("resize",T),r.on("listMsg.hideKeyboard",q),$artificial.on("click",C),r.on("core.buttonchange",g),r.on("core.sessionclose",L),$newMessage.on("click",A),$satisfaction.on("click",S)},N=function(){r.trigger("sendArea.faceShow")},O=function(){T()},F=function(){O(),D()};!function(){M(),r.on("core.statechange",f)}(),r.on("core.onload",function(e){s=e,a=s[0].apiInit.uid,n=s[0].apiInit.cid,r.trigger("sendArea.sendInitConfig",a),F()})}t.exports=n},{"../../../common/util/listener.js":17,"../util/qqFace.js":36,"./evaluate.js":26,"./placeholder.js":28,"./uploadImg.js":30}],28:[function(e,t,s){function n(e,t){var s=e,t=t,n=function(){},a=function(){$(".placeholder").text(t)},o=function(){var e=s.text();""==e?$(".placeholder").show():$(".placeholder").hide()},i=function(){$(".placeholder").hide()},r=function(){s.on("focus",i),s.on("blur",o)},c=function(){o()},u=function(){n(),r(),a()};u(),c()}t.exports=n},{}],29:[function(e,t,s){var n={},a='<div class="evaluate js-evaluate"><p class="h2">是否有以下情况</p><div class="situation"><span>答非所问</span><span style="margin-right:0">理解能力差</span><span>一问三不知</span><span style="margin-right:0">不礼貌</span></div><textarea placeholder="欢迎给我们的服务提建议"></textarea><a class="submit" href="#">提交评价</a></div>',o='<div class="evaluate js-evaluate"><div id="star"><ul><li><a href="javascript:;">1</a></li><li><a href="javascript:;">2</a></li><li><a href="javascript:;">3</a></li><li><a href="javascript:;">4</a></li><li><a href="javascript:;">5</a></li></ul></div></div>',i='<div class="evaluate js-evaluate"><div id="star"><ul><li><a href="javascript:;">1</a></li><li><a href="javascript:;">2</a></li><li><a href="javascript:;">3</a></li><li><a href="javascript:;">4</a></li><li><a href="javascript:;">5</a></li></ul></div><p class="h2">是否有以下情况</p><div class="situation"><span>答非所问</span><span style="margin-right:0">理解能力差</span><span>一问三不知</span><span style="margin-right:0">不礼貌</span></div><textarea placeholder="欢迎给我们的服务提建议"></textarea><a class="submit" href="#">提交评价</a></div>';n.sobotEvaluate_selfHtml=a,n.humanOne_selfHtml=o,n.humanTwo_selfHtml=i,t.exports=n},{}],30:[function(e,t,s){function n(){function t(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total),s=t.toString();console.log(s),n.trigger("sendArea.uploadImgProcess",s)}else alert("请上传正确的图片格式")}var s,n=e("../../../common/util/listener.js"),a="",o="",i=function(){},r=function(){var e=new FormData,t=$(".js-upload")[0],i=t.files[0];if(i.size>=5242880)return void alert("图片大于5M");if(/^(image)/.test(i.type)){var r=new FileReader;r.readAsDataURL(i),r.onload=function(e){o=+new Date,a=s+o,lrz(i,{quality:.7},function(e){n.trigger("sendArea.createUploadImg",[{result:e.base64,date:o,token:a}])})},e.append("file",i),e.append("type","msg"),e.append("countTag",1),e.append("source",0),setTimeout(function(){c(e)},100)}else alert("请上传正确的图片格式");$(".js-upload").val("")},c=function(e){var s=new XMLHttpRequest;s.upload.addEventListener("progress",t,!1),s.open("POST","/wap/js/sendArea/fileupload.json"),s.send(e),s.onreadystatechange=function(e){if(4==e.target.readyState&&200==e.target.status){var t=JSON.parse(e.target.response).url;n.trigger("sendArea.uploadImgUrl",[{url:t,date:o,token:a}])}}},u=function(e){console.log(e)},l=function(){$(".js-upload").on("change",r),n.on("listMsg.imgSendAgain",u)},d=function(){},f=function(e){s=e},g=function(){i(),l(),d(),n.on("sendArea.sendInitConfig",f)};g()}t.exports=n},{"../../../common/util/listener.js":17}],31:[function(e,t,s){function n(t){var s=e("./dialog"),n=this,a=$.extend({text:"TEXT",info:"",OK:function(e){}},t);s.call(this,a);var o=function(){var t=e("./template.js"),s=doT.template(t.AlertTemplate)(a);n.setInner(s)};o()}t.exports=n},{"./dialog":32,"./template.js":37}],32:[function(e,t,s){function n(t){var s,n=e("./template.js"),a=$.extend({okText:"确定",title:"提示",inner:!1,OK:function(){}},t),o=function(){s=$(n.layer);var e=doT.template(n.AlertTemplate)(a);s.html(e)},i=function(e){$(".model-body").html(e),l()},r=function(e){s.animate({opacity:0},300,function(){setTimeout(function(){s.remove()},100)})},c=function(){$(this).addClass("active").siblings().removeClass("active")},u=function(){s.delegate(".close_button","click",r),$(".wether span").on("click",c)},l=function(){var e,t;e=($(window).width()-.9*$(window).width())/2+"px",t=($(window).height()-$(".js-modeDialog").height())/2+"px",$(".js-modeDialog").css({left:e,top:t})},d=function(){$(document.body).append(s),$(".js-modeDialog").animate({opacity:1},300),u(),l()},f=function(){o()};f(),this.setInner=i,this.show=d,this.hide=r}t.exports=n},{"./template.js":37}],33:[function(e,t,s){var n={};n.qqfaceReg=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/g,n.qqfaceReg2=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/,t.exports=n},{}],34:[function(e,t,s){t.exports={"[微笑]":"weixiao","[撇嘴]":"piezui","[色]":"se","[发呆]":"fadai","[得意]":"deyi","[流泪]":"liulei","[害羞]":"haixiu","[闭嘴]":"bizui","[睡]":"shui","[大哭]":"daku","[尴尬]":"ganga","[发怒]":"fanu","[调皮]":"tiaopi","[呲牙]":"ciya","[惊讶]":"jingya","[难过]":"nanguo","[酷]":"ku","[冷汗]":"lenghan","[抓狂]":"zhuakuang","[吐]":"tu","[偷笑]":"touxiao","[愉快]":"yukuai","[白眼]":"baiyan","[傲慢]":"aoman","[饥饿]":"jie","[困]":"kun","[惊恐]":"jingkong"}},{}],35:[function(e,t,s){t.exports={"/::)":"1","/::~":"2","/::B":"3","/::|":"4","/:8-)":"5","/::<":"6","/::$":"7","/::X":"8","/::Z":"9","/::'(":"10","/::-|":"11","/::@":"12","/::P":"13","/::D":"14","/::O":"15","/::(":"16","/::+":"17","/:–b":"18","/::Q":"19","/::T":"20","/:,@P":"21","/:,@-D":"22","/::d":"23","/:,@o":"24","/::g":"25","/:|-)":"26","/::!":"27","/微笑":"1","/撇嘴":"2","/色":"3","/发呆":"4","/得意":"5","/流泪":"6","/害羞":"7","/闭嘴":"8","/睡":"9","/大哭":"10","/尴尬":"11","/发怒":"12","/调皮":"13","/呲牙":"14","/惊讶":"15","/难过":"16","/酷":"17","/冷汗":"18","/抓狂":"19","/吐":"20","/偷笑":"21","/愉快":"22","/白眼":"23","/傲慢":"24","/饥饿":"25","/困":"26","/惊恐":"27","[微笑]":"1","[撇嘴]":"2","[色]":"3","[发呆]":"4","[得意]":"5","[流泪]":"6","[害羞]":"7","[闭嘴]":"8","[睡]":"9","[大哭]":"10","[尴尬]":"11","[发怒]":"12","[调皮]":"13","[呲牙]":"14","[惊讶]":"15","[难过]":"16","[酷]":"17","[冷汗]":"18","[抓狂]":"19","[吐]":"20","[偷笑]":"21","[愉快]":"22","[白眼]":"23","[傲慢]":"24","[饥饿]":"25","[困]":"26","[惊恐]":"27"}},{}],36:[function(e,t,s){function n(){var t=e("../../../common/util/listener.js"),s=e("./face/weixin.json"),n=e("./face/weixinsymbol.json"),a=e("./face/Reg.js"),o=s,i=n,r=a.qqfaceReg,c=a.qqfaceReg2,u={},l=function(){$faceGroup=$(".js-faceGroup")},d=function(){if($("#faceBox").length<=0){var e=0,s='<div id="faceBox" class="face">';for(var n in o)e+=1,s+=27==e?'<span class="faceIco js-faceIco faceIco'+e+'" data-src="'+n+'" /></span><span class="backDelete"></span>':'<span class="faceIco js-faceIco faceIco'+e+'" data-src="'+n+'" /></span>';s+="</div>",$faceGroup.append(s),$(".backDelete").unbind(),$(".backDelete").bind("click",function(){t.trigger("sendArea.backDelete")})}f()},f=function(){$(".js-faceIco").unbind(),$(".js-faceIco").bind("click",function(e){var s=e.currentTarget,n=$(s).attr("data-src");t.trigger("sendArea.gotoxy",[{answer:n}])})},g=function(e){if(!e)return!1;var t=e.match(r);if(t)for(var s=0;s<t.length;s++){var n=c.exec(e),a=i[n[0]];e=e.replace(c,'<span class="msgfaceIco faceIco faceIco'+a+'" /></span>')}return e},p=function(){t.on("sendArea.faceShow",d)},m=function(){},h=function(){l(),p(),m()};return h(),u.analysis=g,u}t.exports=n},{"../../../common/util/listener.js":17,"./face/Reg.js":33,"./face/weixin.json":34,"./face/weixinsymbol.json":35}],37:[function(e,t,s){var n={},a='<div class="layer js-layer"></div>',o='<div class="modeDialog js-modeDialog"><div class="close"><span class="close_button">×</span></div><p class="h1">{{=it.title || "提示"}}</p>{{ if((it.footer !== false) ) { }}<div class="wether"><span class="js-isques">{{=it.okText || "确定"}}</span><span class="js-noques">{{=it.cancelText || "取消"}}</span></div>{{ } }}<div class="model-body"></div></div>';n.AlertTemplate=o,n.layer=a,t.exports=n},{}]},{},[20]);